---
import { getCollection } from 'astro:content';
import NewsCard from '@components/cards/News.astro';
import Layout from '@layouts/BaseLayout.astro';
import { sortByDateDesc } from '@utils/pagination';

const successStories = await getCollection('success-stories');
const sortedSuccessStories = sortByDateDesc(successStories);

const meta = {
  title: 'Success Stories | Digital Dundee',
  description:
    "Discover the success stories from Dundee's thriving digital and tech sector",
  ogImage: 'generic-social-1200x630.png',
  pageTitle: 'Success Stories',
};
---

<Layout metaData={meta}>
  <main class="wrapper flow">
    <h1>Success Stories</h1>

    {
      sortedSuccessStories.length > 0 ? (
        <section class="grid">
          {sortedSuccessStories.map((item) => (
            <NewsCard
              title={item.data.title}
              excerpt={item.data.excerpt}
              pubDate={item.data.pubDate}
              imageSrc={item.data.imagePrimary.src}
              imageAlt={item.data.imagePrimary.alt}
              href={`/success-stories/${item.id}`}
            />
          ))}
        </section>
      ) : (
        <p>No success stories found.</p>
      )
    }
  </main>
</Layout>

<style>
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
    margin-block: 2rem;
  }

  @media (max-width: 768px) {
    .grid {
      grid-template-columns: 1fr;
    }
  }
</style>
